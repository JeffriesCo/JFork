<!DOCTYPE html>
<html>
<head>
  <meta charset="utf-8">
  <title>JFork Class Test Cases</title>
  <link rel="stylesheet" href="../qunit.css">
  <script type="text/javascript" src="../../jfork-2.0.js"></script>
</head>
<body>
<div id="qunit"></div>
<div id="qunit-fixture"></div>
<script src="../qunit.js"></script>
<script>


module("Basic Use Cases");



test("instance independence", function() {
	var Animal = jfork.Class({
		hasTeeth:false,
		numLegs:4,
		setNumLegs:function(numLegs){
			this.numLegs = numLegs;
		},
		getNumLegs:function(){
			return this.numLegs;
		}
	});
	var dog = Animal();
	var spider = Animal();
	
	ok(Animal.numLegs == undefined,"Animal.numLegs == undefined");
	ok(dog.numLegs == 4,"dog.numLegs == 4");
	
	spider.numLegs = 8;
	ok(spider.numLegs == 8,"spider.numLegs == 8");
	ok(dog.numLegs == 4,"dog.numLegs == 4");
	
	dog.setNumLegs(3);
	ok(spider.numLegs == 8,"spider.numLegs == 8");
	ok(dog.numLegs == 3,"dog.numLegs == 3");
	
	var cat = Animal();
	ok(cat.numLegs == 4,"cat.numLegs == 4");
	ok(spider.numLegs == 8,"spider.numLegs == 8");
	ok(dog.numLegs == 3,"dog.numLegs == 3");
});






module("Variables");

test("public dynamic on instance", function() {
	
	var Animal = jfork.Class({
		var1:"a",
		"var2":"b",
		"String var3":"c",
		"Number var4":1,
		"unknown var5":"yoyo",
		"Variant var6":"hello"
	});
	
	var dog = Animal();
	
	ok(dog.var1=="a","var1==a");
	ok(dog.var2=="b","var2==b");
	ok(dog.var3=="c","var3==c");
	ok(dog.var4==1,"var4==1");
	ok(dog.var5=="yoyo","var5==yoyo");
	ok(dog.var6=="hello","var6==hello");
	
	dog.var1 = 5;
	ok(dog.var1==5,"var1==5");
	dog.var2 = 6;
	ok(dog.var2==6,"var2==6");
	dog.var3 = "car";
	ok(dog.var3=="car","var3==car");
	dog.var4 = 1.5;
	ok(dog.var4==1.5,"var4==1.5");
	dog.var5 = "anything";
	ok(dog.var5=="anything","var5==anything");
	dog.var6 = "everything";
	ok(dog.var6=="everything","var6==everything");
	
	throws(function(){
		dog.var3 = new Date();
	},"dog.var3=Date throws");
	
	throws(function(){
		dog.var4 = new Date();
	},"dog.var4=Date throws");
	
});



test("public dynamic through methods",function(){
	
	var Animal = jfork.Class({
		var1:"a",
		"var2":"b",
		"String var3":"c",
		"Number var4":1,
		"unknown var5":"yoyo",
		"Variant var6":"hello",
		setVar1:function(v){ this.var1 = v; },
		setVar2:function(v){ this.var2 = v; },
		setVar3:function(v){ this.var3 = v; },
		setVar4:function(v){ this.var4 = v; },
		setVar5:function(v){ this.var5 = v; },
		setVar6:function(v){ this.var6 = v; }
	});
	
	var dog = Animal();

	dog.setVar1(5);
	ok(dog.var1==5,"var1==5");
	dog.setVar2(6);
	ok(dog.var2==6,"var2==6");
	dog.setVar3("car");
	ok(dog.var3=="car","var3==car");
	dog.setVar4(1.5);
	ok(dog.var4==1.5,"var4==1.5");
	dog.setVar5("anything");
	ok(dog.var5=="anything","var5==anything");
	dog.setVar6("everything");
	ok(dog.var6=="everything","var6==everything");
	
	throws(function(){
		dog.setVar3(new Date());
	},"dog.var3=Date throws");
	
	throws(function(){
		dog.setVar4(new Date());
	},"dog.var4=Date throws");
	
	
});




test("private dynamic",function(){
	
	var Animal = jfork.Class({
		"private var1":123,
		"private Array var2":null,
		"private String var3":"c",
		"private Number var4":1,
		"private unknown var5":"yoyo",
		"private Variant var6":"hello",

		"private setVar1":				function(v){ this.var1 = v; },
		"private setVar2(v)":			function(v){ this.var2 = v; },
		"private setVar3(String v)":	function(v){ this.var3 = v; },
		"private setVar4(asdf v)":		function(v){ this.var4 = v; },
		"private setVar5(Variant v)":	function(v){ this.var5 = v; },
		"private setVar6(v)":			function(v){ this.var6 = v; },
		
		getSet1:function(v){ this.setVar1(v); return this.var1; },
		getSet2:function(v){ this.setVar2(v); return this.var2; },
		getSet3:function(v){ this.setVar3(v); return this.var3; },
		getSet4:function(v){ this.setVar4(v); return this.var4; },
		getSet5:function(v){ this.setVar5(v); return this.var5; },
		getSet6:function(v){ this.setVar6(v); return this.var6; }
	});
	
	var dog = Animal();

	ok(dog.setVar1==undefined);
	ok(dog.var1==undefined);
	ok(dog.getSet1(25)==25);
	
	ok(dog.setVar2==undefined);
	ok(dog.var2==undefined);
	ok(dog.getSet2([1,2,3]).length==3);
	
	ok(dog.setVar3==undefined);
	ok(dog.var3==undefined);
	ok(dog.getSet3("hello")=="hello");
	
	ok(dog.setVar4==undefined);
	ok(dog.var4==undefined);
	ok(dog.getSet4(123)==123);
	
	ok(dog.setVar5==undefined);
	ok(dog.var5==undefined);
	ok(dog.getSet5("anything")=="anything");
	
	ok(dog.setVar6==undefined);
	ok(dog.var6==undefined);
	ok(dog.getSet6("more anything")=="more anything");
	
	throws(function(){
		dog.getSet3(new Date());
	},"dog.var3=Date throws");
	
	throws(function(){
		dog.getSet4(new Date());
	},"dog.var4=Date throws");
	
});




test("Static",function(){
	
	var Animal = jfork.Class({
		var1:"a",
		"static var2":"b",
		"static String var3":"c",
		"static Number var4":1,
		"static Unknown var5":"yoyo",
		"static Variant var6":"hello",
		setVar1:function(v){ this.var1 = v; },
		setVar2:function(v){ this.var2 = v; },
		setVar3:function(v){ this.var3 = v; },
		setVar4:function(v){ this.var4 = v; },
		setVar5:function(v){ this.var5 = v; },
		setVar6:function(v){ this.var6 = v; },
		getVar1:function(){ return this.var1; },
		getVar2:function(){ return this.var2; },
		getVar3:function(){ return this.var3; },
		getVar4:function(){ return this.var4; },
		getVar5:function(){ return this.var5; },
		getVar6:function(){ return this.var6; },
	});
	
	var dog = Animal();
	var cat = Animal();
	
	ok(Animal.var1==undefined);
	ok(Animal.var2=="b");
	ok(Animal.var3=="c");
	ok(Animal.var4==1);
	ok(Animal.var5=="yoyo");
	ok(Animal.var6=="hello");
	
	ok(dog.var1=="a");
	ok(dog.var2=="b");
	ok(dog.var3=="c");
	ok(dog.var4==1);
	ok(dog.var5=="yoyo");
	ok(dog.var6=="hello");
	
	Animal.var2 = 1;
	ok(Animal.var2==1);
	ok(dog.var2==1);
	ok(cat.getVar2()==1);
	
	dog.var2 = 2;
	ok(Animal.var2==2);
	ok(dog.var2==2);
	ok(cat.getVar2()==2);
	
	cat.setVar2(3);
	ok(Animal.var2==3);
	ok(dog.var2==3);
	ok(cat.getVar2()==3);
	
	var spider = Animal();
	ok(spider.var2==3);
	ok(spider.getVar2()==3);
	
	spider.var2 = 4;
	ok(Animal.var2==4);
	ok(dog.var2==4);
	ok(cat.getVar2()==4);
	
	throws(function(){
		dog.var4 = "asdf";
	});
	
	throws(function(){
		cat.setVar3(new Date());
	});
	
});



test("Private Static",function(){
	
	var Animal = jfork.Class({
		var1:"a",
		"private static var2":"b",
		"private static String var3":"c",
		"private static Number var4":1,
		"private static Unknown var5":"yoyo",
		"private static Variant var6":"hello",
		"static setVar1":function(v){ this.var1 = v; },
		"static setVar2":function(v){ this.var2 = v; },
		"static setVar3":function(v){ this.var3 = v; },
		setVar4:function(v){ this.var4 = v; },
		"static setVar5":function(v){ this.var5 = v; },
		"static setVar6":function(v){ this.var6 = v; },
		"static getVar1":function(){ return this.var1; },
		"static getVar2":function(){ return this.var2; },
		"static getVar3":function(){ return this.var3; },
		getVar4:function(){ return this.var4; },
		"static getVar5":function(){ return this.var5; },
		"static getVar6":function(){ return this.var6; },
	});
	
	var dog = Animal();
	
	
	ok(Animal.var1==undefined);
	ok(Animal.var2==undefined);
	ok(Animal.var3==undefined);
	ok(Animal.var4==undefined);
	ok(Animal.var5==undefined);
	ok(Animal.var6==undefined);
	
	ok(dog.var1=="a");
	ok(dog.var2==undefined);
	ok(dog.var3==undefined);
	ok(dog.var4==undefined);
	ok(dog.var5==undefined);
	ok(dog.var6==undefined);
	
	ok(Animal.getVar1()==undefined);
	ok(dog.getVar1()==undefined);
	
	Animal.setVar1("anything");
	ok(dog.var1=="a");
	
	dog.setVar1("something");
	ok(dog.var1=="a");
	
	ok(Animal.getVar2()=="b");
	ok(Animal.getVar3()=="c");
	ok(Animal.getVar4==undefined);
	ok(Animal.getVar5()=="yoyo");
	ok(Animal.getVar6()=="hello");
	
	ok(dog.getVar2()=="b");
	ok(dog.getVar3()=="c");
	ok(dog.getVar4()==1);
	ok(dog.getVar5()=="yoyo");
	ok(dog.getVar6()=="hello");
	
	Animal.setVar2("turtle");
	ok(Animal.getVar2()=="turtle");
	ok(dog.getVar2()=="turtle");
	
	dog.setVar4(22);
	ok(dog.getVar4()==22);
	
	var cat = Animal();
	ok(cat.getVar2()=="turtle");
	ok(cat.getVar4()==22);

	throws(function(){
		cat.setVar4("any string");
	});
	
	throws(function(){
		Animal.setVar3(85);
	});
	
});









module("Methods");



test("Argument Types",function(){
	
	var Animal = jfork.Class({
		v1:null,
		m1:					function(v){ this.v1 = v; },
		"m2()":				function(){ this.v1 = "yep"; },
		"m3(v)":			function(v){ this.v1 = v; },
		"m4(unknown v)":	function(v){ this.v1 = v; },
		"m5(String v)":		function(v){ this.v1 = v; },
		"m6(v,w)":			function(v,w){ this.v1 = v+w; },
		"m7(Array v)":		function(v){ this.v1 = v.length; },
		"m8(Integer a, Array b, String c)":	function(a,b,c){ this.v1 = a+","+b.length+","+c; },
		
		"m9(Integer[] asdfasdf)":	function(v){ this.v1 = v.length; },
		"m10(unknown[] a, String[] b, c)": function(a,b,c){ this.v1 = a.length+b.length+c.length; },
		
		"m11({v})":			function(v){ this.v1 = v.v; },
		"m12({Variant a, String b, c})":	function(v){ this.v1 = v.a +","+v.b+","+v.c; }		
	});
	
	var dog = Animal();
	
	dog.m1("anything");
	ok(dog.v1=="anything");
	
	dog.m2();
	ok(dog.v1=="yep");
	throws(function(){
		dog.m2("anything");
	});
	
	dog.m3("anything");
	ok(dog.v1=="anything");
	throws(function(){
		dog.m3("good","too much");
	});
	
	dog.m4("anythingagain");
	ok(dog.v1=="anythingagain");
	throws(function(){
		dog.m4(); //Too little
	});
	
	dog.m5("Any String");
	ok(dog.v1=="Any String");
	throws(function(){
		dog.m5(123);
	});
	
	dog.m6(5,6);
	ok(dog.v1==11);
	throws(function(){
		dog.m6("too little");
	});
	throws(function(){
		dog.m6(1,2,"too much");
	});
	
	dog.m7([1,2,3]);
	ok(dog.v1==3);
	throws(function(){
		dog.m7("must be an array");
	});
	
	dog.m8(123, [1,2,3], "three");
	ok(dog.v1=="123,3,three");
	throws(function(){
		dog.m8(132, [1,2,3], 123);
	});
	
	dog.m9([1,2,3]);
	ok(dog.v1==3);
	throws(function(){
		dog.m9([1,"hello",3]);
	});
	throws(function(){
		dog.m9(123);
	});
	
	dog.m10([1,new Date()],["one","two","three"],[1,2,3,4]);
	ok(dog.v1="2,3,4");
	throws(function(){
		dog.m10("asdf",["one","two","three"],[1,2,3,4]);
	});
	throws(function(){
		dog.m10([1,new Date()],["one",123,"three"],[1,2,3,4]);
	});
	
	dog.m11({v:"hello"});
	ok(dog.v1=="hello");
	throws(function(){
		dog.m11("hello");
	});
	throws(function(){
		dog.m11({wrong:"hello"});
	});
	
	dog.m12({a:123,b:"hello",c:"hmm"});
	ok(dog.v1=="123,hello,hmm");
	throws(function(){
		dog.m12({a:123,bbb:"hello",c:"hmm"});
	});
	throws(function(){
		dog.m12({a:123,c:"hmm"});
	});
	throws(function(){
		dog.m12({a:123,bbb:123,c:"hmm"});
	});
	
});




test("Return Types",function(){
	
	var Animal = jfork.Class({
		m1:function(v){ return v; },
		"m2(v)":function(v){ return v; },
		"unknown m3(v)":function(v){ return v; },
		"Variant m4(v)":function(v){ return v; },
		"String m5(v)":function(v){ return v; },
		"Integer[] m6(v)":function(v){ return v; },
		"Array m7(v)":function(v){ return v; },
		"Object m8(v)":function(v){ return v; }
	});
	
	var dog = Animal();
	
	ok(dog.m1("hello")=="hello");
	
	ok(dog.m2("world")=="world");
	
	ok(dog.m3("yoyo")=="yoyo");
	
	ok(dog.m4("whatup")=="whatup");
	
	ok(dog.m5("dog")=="dog");
	throws(function(){
		dog.m5(123);
	});
	
	ok(dog.m6([1,2,3]).length==3);
	ok(dog.m6([]).length==0);
	throws(function(){
		dog.m6(["asdf",1]);
	});
	throws(function(){
		dog.m6();
	});
	
	ok(dog.m7(["asdf",123,"hmm"]));
	ok(dog.m7([]));
	throws(function(){
		dog.m7(123);
	});
	throws(function(){
		dog.m7();
	});
	
	ok(dog.m8({a:1}).a==1);
	throws(function(){
		dog.m8(new Date());
	});
	throws(function(){
		dog.m8();
	});
	throws(function(){
		dog.m8([]);
	});
});





test("Overloading",function(){

	//Note: Two methods with exactly the same name will be overriden on any JS object by the newest
	
	throws(function(){
		jfork.Class({
			m1:function(){},
			"m1()":function(){}
		});		
	});

	throws(function(){
		jfork.Class({
			m1:function(){},
			"m1(v)":function(){}
		});		
	});
	
	throws(function(){
		jfork.Class({
			m1:function(){},
			"m1(String v)":function(){}
		});		
	});
	
	throws(function(){
		jfork.Class({
			"m1(v)":function(){},
			"m1(String v)":function(){}
		});		
	});

	throws(function(){
		jfork.Class({
			"m1(unknown v)":function(){},
			"m1(String v)":function(){}
		});		
	});	

	throws(function(){
		jfork.Class({
			"String m1(v)":function(){ return "a"; },
			"Integer m1(v)":function(){ return 1; }
		});		
	});
	
	var Animal = jfork.Class({
		"static m0(Integer a)":function(){
			return 1;
		},
		"static m0(a,String b)":function(){
			return 2;
		},
		"static m0(Integer a, Integer b)":function(){
			return 3;
		},
		"static m0({a,b})":function(){
			return 4;
		},
		"m1(Integer v)":function(){
			return 1;
		},
		"m1(String v)":function(){
			return 2;
		}
	});
	
	var dog = Animal();
	
	ok(dog.m1(1)==1);
	ok(dog.m1("asdf")==2);
	throws(function(){
		dog.m1();
	});
	throws(function(){
		dog.m1(new Date());
	});

	ok(dog.m0(1)==1);
	ok(dog.m0("asdf","123")==2);
	ok(dog.m0(1,2)==3);
	ok(dog.m0({a:1,b:2})==4);
	
	ok(Animal.m0(1)==1);
	ok(Animal.m0("asdf","123")==2);
	ok(Animal.m0(1,2)==3);
	ok(Animal.m0({a:1,b:2})==4);
	
	
});





test("Static",function(){
	
	ok(true);
	
});



test("Private",function(){
	
	ok(true);
	
});



test("Private Static",function(){
	
	ok(true);
	
});


/*












module("Constructors");






module("Inheritance");


test("instanceof", function(){
	
	var Animal = jfork.Class({});	
	var Mammal = Animal.extend({});	
	var Person = Mammal.extend({});
	
	var ant = Animal();
	var lion = Mammal();
	var bob = Person();
	
	ok(ant instanceof Object);
	ok(ant instanceof Animal);
	
	ok(lion instanceof Object);
	ok(lion instanceof Animal);
	ok(lion instanceof Mammal);
	
	ok(bob instanceof Object);
	ok(bob instanceof Animal);
	ok(bob instanceof Mammal);
	ok(bob instanceof Person);
	
});




module("Add Custom Types");






module("Complex Tests");



*/
  
</script>
</body>
</html>